import{R as W,r as A,j as n,a6 as K,a7 as $,a8 as P}from"./vendor-react-mWVLDlSi.js";import{L as O}from"./vendor-maps-C_U1R0uQ.js";import{i as H}from"./indonesia-prov-BYnfc21a.js";import{u as D}from"./index-C95-8iH3.js";const F=JSON.parse(H),M={Jakarta:"DKI JAKARTA","Jakarta Pusat":"DKI JAKARTA","Jakarta Selatan":"DKI JAKARTA","Jakarta Barat":"DKI JAKARTA","Jakarta Timur":"DKI JAKARTA","Jakarta Utara":"DKI JAKARTA",Bandung:"JAWA BARAT",Bogor:"JAWA BARAT",Depok:"JAWA BARAT",Bekasi:"JAWA BARAT",Cirebon:"JAWA BARAT",Tasikmalaya:"JAWA BARAT",Sukabumi:"JAWA BARAT",Cikampek:"JAWA BARAT",Cianjur:"JAWA BARAT",Kuningan:"JAWA BARAT",Semarang:"JAWA TENGAH",Solo:"JAWA TENGAH",Yogyakarta:"DAERAH ISTIMEWA YOGYAKARTA",Tegal:"JAWA TENGAH",Purwokerto:"JAWA TENGAH",Pekalongan:"JAWA TENGAH",Madiun:"JAWA TENGAH",Blora:"JAWA TENGAH",Klaten:"JAWA TENGAH",Jepara:"JAWA TENGAH","Madiun (Bojonegoro)":"JAWA TENGAH",Surabaya:"JAWA TIMUR",Malang:"JAWA TIMUR",Jember:"JAWA TIMUR",Kediri:"JAWA TIMUR",Banyuwangi:"JAWA TIMUR",Probolinggo:"JAWA TIMUR",Pamekasan:"JAWA TIMUR",Bangkalan:"JAWA TIMUR",Tangerang:"BANTEN",Serang:"BANTEN",Medan:"SUMATERA UTARA","Pematang Siantar":"SUMATERA UTARA",Tarutung:"SUMATERA UTARA","Rantau Prapat":"SUMATERA UTARA",Padang:"SUMATERA BARAT",Payakumbuh:"SUMATERA BARAT",Palembang:"SUMATERA SELATAN",Lahat:"SUMATERA SELATAN",Lubuklinggau:"SUMATERA SELATAN",Pekanbaru:"RIAU",Dumai:"RIAU",Tembilahan:"RIAU",Batam:"KEPULAUAN RIAU",Bintan:"KEPULAUAN RIAU",Lampung:"LAMPUNG",Kotabumi:"LAMPUNG",Jambi:"JAMBI",Bengkulu:"BENGKULU",Aceh:"DI. ACEH",Bangka:"BANGKA BELITUNG",Belitung:"BANGKA BELITUNG",Pontianak:"KALIMANTAN BARAT",Ketapang:"KALIMANTAN BARAT",Sanggau:"KALIMANTAN BARAT",Palangkaraya:"KALIMANTAN TENGAH","Pangkalan Bun":"KALIMANTAN TENGAH",Banjarmasin:"KALIMANTAN SELATAN",Balikpapan:"KALIMANTAN TIMUR",Samarinda:"KALIMANTAN TIMUR",Berau:"KALIMANTAN TIMUR",Tarakan:"KALIMANTAN UTARA",Manado:"SULAWESI UTARA",Palu:"SULAWESI TENGAH","Palu/Luwuk":"SULAWESI TENGAH",Makassar:"SULAWESI SELATAN","Pare Pare":"SULAWESI SELATAN",Palopo:"SULAWESI SELATAN",Bulukumba:"SULAWESI SELATAN",Kendari:"SULAWESI TENGGARA",Gorontalo:"GORONTALO",Ambon:"MALUKU",Ternate:"MALUKU UTARA",Timika:"PAPUA",Jayapura:"PAPUA",Marauke:"PAPUA",Sorong:"PAPUA BARAT",Manokwari:"PAPUA BARAT",Denpasar:"BALI",Mataram:"NUSATENGGARA BARAT",Bima:"NUSATENGGARA BARAT",Kupang:"NUSA TENGGARA TIMUR",Waikabubak:"NUSA TENGGARA TIMUR",Ruteng:"NUSA TENGGARA TIMUR",Ende:"NUSA TENGGARA TIMUR",Atambua:"NUSA TENGGARA TIMUR",Larantuka:"NUSA TENGGARA TIMUR"},z={"Region 1":"#ef4444","Region 2":"#3b82f6","Region 3":"#10b981","Region 4":"#f59e0b","Region 5":"#8b5cf6","Region 6":"#ec4899","Region 7":"#14b8a6","Region 8":"#f97316","Region 9":"#6366f1","Region 10":"#eab308"},b=c=>z[c]||"#94a3b8",Z=W.memo(function({machines:s,engineers:d=[],onEngineerClick:x,isFullscreen:h=!1}){const[T,k]=A.useState(null),[q,_]=A.useState(null),[C,E]=A.useState(!0),{theme:v,isDark:o}=D(),f=A.useMemo(()=>{const e={};return(d||[]).forEach(t=>{const a=t.area_group||"Unknown",r=t.region||"Unknown",i=M[a]||a;e[i]||(e[i]={areaGroup:i,cities:new Set,region:r,engineerCount:0,machineCount:0,engineers:[],latitude:0,longitude:0,validCoords:0}),e[i].cities.add(a),e[i].engineerCount++,e[i].engineers.push(t),t.latitude&&t.longitude&&(e[i].latitude+=parseFloat(t.latitude),e[i].longitude+=parseFloat(t.longitude),e[i].validCoords++)}),Object.keys(e).forEach(t=>{e[t].validCoords>0&&(e[t].latitude/=e[t].validCoords,e[t].longitude/=e[t].validCoords)}),(s||[]).forEach(t=>{const a=t.area_group||"Unknown",r=M[a]||a;e[r]||(e[r]={areaGroup:r,cities:new Set,region:"Unknown",engineerCount:0,machineCount:0,engineers:[],latitude:0,longitude:0,validCoords:0}),e[r].machineCount++}),e},[d,s]),p=A.useRef(null);if(A.useEffect(()=>(T&&Object.keys(f).length>0&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{const e=()=>{const t=O.latLngBounds();Object.values(f).forEach(a=>{a.latitude&&a.longitude&&a.validCoords>0&&t.extend([a.latitude,a.longitude])}),t.isValid()&&T.fitBounds(t,{padding:[50,50],animate:!1})};window.requestIdleCallback?window.requestIdleCallback(e,{timeout:500}):requestAnimationFrame(()=>{requestAnimationFrame(e)})},300)),()=>{p.current&&clearTimeout(p.current)}),[T,f]),(!d||d.length===0)&&(!s||s.length===0))return n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx("div",{className:"text-slate-400",children:"No data available"})});const l=Object.values(f).filter(e=>e.validCoords>0||e.machineCount>0).sort((e,t)=>t.engineerCount+t.machineCount-(e.engineerCount+e.machineCount)),y=A.useMemo(()=>{const e={};return l.forEach(t=>{const a=t.region||"Unknown";e[a]||(e[a]={region:a,provinceCount:0,totalMachines:0,totalEngineers:0,provinces:[]}),e[a].provinceCount++,e[a].totalMachines+=t.machineCount,e[a].totalEngineers+=t.engineerCount,e[a].provinces.push({name:t.areaGroup,machines:t.machineCount,engineers:t.engineerCount})}),Object.keys(e).forEach(t=>{e[t].provinces.sort((a,r)=>r.machines-a.machines)}),e},[l]),S=A.useMemo(()=>l.sort((e,t)=>t.machineCount-e.machineCount).slice(0,5).map(e=>({name:e.areaGroup,machines:e.machineCount,engineers:e.engineerCount,region:e.region})),[l]),R=A.useMemo(()=>Math.max(...l.map(e=>e.engineerCount),1),[l]),I=A.useCallback(e=>{const t=e.properties.Propinsi||e.properties.name||"",a=l.find(g=>t.toUpperCase()===g.areaGroup.toUpperCase());let r,u=1.5,i=.4;if(a){r=b(a.region);const g=a.engineerCount/R;u=1.5+g*4.5,i=.4+g*.5}else r="#e5e7eb",u=1,i=.15;return{fillColor:r,fillOpacity:i,color:"#ffffff",weight:u,opacity:.95}},[l,R]),B=A.useCallback((e,t)=>{const a=e.properties.Propinsi||e.properties.name||"",r=l.find(u=>a.toUpperCase()===u.areaGroup.toUpperCase());if(r){const u=b(r.region),i=r.engineerCount/R,g=1.5+i*4.5,L=.4+i*.5,G=Array.from(r.cities||[]).join(", "),w=o?"#0f172a":"#ffffff",m=o?"#ffffff":"#0f172a",J=u,j=o?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.2)";t.bindTooltip(`<div style="background: ${w}; padding: 12px 16px; border-radius: 8px; box-shadow: 0 8px 16px ${j}; border: 2px solid ${J}; line-height: 1.8; overflow: hidden;">
            <div style="font-weight: 700; font-size: 14px; margin-bottom: 8px; color: ${m};">ğŸ“ ${r.areaGroup}</div>
            <div style="color: ${m}; margin-bottom: 6px;">ğŸ™ï¸ ${G}</div>
            <div style="color: ${m}; margin-bottom: 6px;">ğŸ–¥ï¸ <span style="color: ${m}; font-weight: 700;">${r.machineCount||0}</span> mesin</div>
            <div style="color: ${m}; margin-bottom: 6px;">ğŸ‘· <span style="color: ${m}; font-weight: 700;">${r.engineerCount}</span> engineers</div>
            <div style="color: ${m}; font-size: 12px; opacity: 0.9;">ğŸ—ºï¸ ${r.region}</div>
          </div>`,{sticky:!0,className:"custom-map-tooltip",direction:"auto",permanent:!1});let N=null;t.on({mouseover:U=>{N&&clearTimeout(N),N=setTimeout(()=>{requestAnimationFrame(()=>{U.target.setStyle({fillOpacity:.95,weight:g+2})})},16)},mouseout:U=>{N&&clearTimeout(N),requestAnimationFrame(()=>{U.target.setStyle({fillOpacity:L,weight:g})})}})}},[l,R,o]);return n.jsxs("div",{className:"map-container relative",style:{height:"100%",width:"100%",borderRadius:h?"0":"16px",overflow:"hidden",boxShadow:h?"none":"0 20px 25px -5px rgba(0, 0, 0, 0.3)",border:h?"none":"1px solid rgba(59, 130, 246, 0.2)"},children:[n.jsxs(K,{center:[-2.5489,118.0149],zoom:5,style:{height:"100%",width:"100%"},whenCreated:k,zoomControl:!0,children:[n.jsx($,{url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),n.jsx(P,{data:F,style:I,onEachFeature:B},`geojson-${v}`)]}),C?n.jsxs("div",{className:`absolute top-4 right-4 z-[100] ${o?"bg-slate-900/95":"bg-white/95"} backdrop-blur-sm rounded-lg border ${o?"border-slate-700":"border-gray-300"} shadow-xl p-4 max-w-xs`,children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h3",{className:`font-bold text-sm ${o?"text-white":"text-gray-900"}`,children:"ğŸ—ºï¸ Legend"}),n.jsx("button",{onClick:()=>E(!1),className:`p-1 rounded hover:${o?"bg-slate-800":"bg-gray-100"} transition-colors ${o?"text-slate-400 hover:text-white":"text-gray-500 hover:text-gray-700"}`,title:"Sembunyikan Legend",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:`text-xs font-semibold mb-2 ${o?"text-slate-300":"text-gray-700"}`,children:"Region"}),n.jsx("div",{className:"space-y-1.5",children:["Region 1","Region 2","Region 3"].map(e=>{const t=b(e),a=y[e];return n.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[n.jsx("div",{className:"w-4 h-4 rounded border-2 border-white shadow-sm",style:{backgroundColor:t}}),n.jsx("span",{className:`flex-1 ${o?"text-slate-200":"text-gray-800"}`,children:e}),a&&n.jsxs("span",{className:`font-semibold ${o?"text-slate-400":"text-gray-600"}`,children:[a.provinceCount," prov"]})]},e)})})]}),S.length>0&&n.jsxs("div",{children:[n.jsx("p",{className:`text-xs font-semibold mb-2 ${o?"text-slate-300":"text-gray-700"}`,children:"ğŸ† Top 5 Provinsi (Mesin)"}),n.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:S.map((e,t)=>{const a=b(e.region);return n.jsxs("div",{className:`flex items-center gap-2 text-xs p-1.5 rounded ${o?"bg-slate-800/50":"bg-gray-50"} hover:${o?"bg-slate-800":"bg-gray-100"} transition-colors`,children:[n.jsx("span",{className:`font-bold w-5 text-center ${o?"text-slate-400":"text-gray-500"}`,children:t+1}),n.jsx("div",{className:"w-3 h-3 rounded border border-white/50",style:{backgroundColor:a}}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:`font-medium truncate ${o?"text-slate-200":"text-gray-800"}`,children:e.name}),n.jsxs("div",{className:`text-xs ${o?"text-slate-400":"text-gray-600"}`,children:[e.machines," mesin"]})]})]},t)})})]})]}):n.jsx("button",{onClick:()=>E(!0),className:`absolute top-4 right-4 z-[100] ${o?"bg-slate-900/95 hover:bg-slate-800":"bg-white/95 hover:bg-gray-50"} backdrop-blur-sm rounded-lg border ${o?"border-slate-700":"border-gray-300"} shadow-xl p-2 transition-colors`,title:"Tampilkan Legend",children:n.jsx("svg",{className:`w-5 h-5 ${o?"text-slate-300":"text-gray-700"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})},(c,s)=>{var d,x,h,T;return!(c.isFullscreen!==s.isFullscreen||c.onEngineerClick!==s.onEngineerClick||c.machines!==s.machines&&((d=c.machines)==null?void 0:d.length)!==((x=s.machines)==null?void 0:x.length)||c.engineers!==s.engineers&&((h=c.engineers)==null?void 0:h.length)!==((T=s.engineers)==null?void 0:T.length))});export{Z as default};
